function AApplication(){this.rootContainer=null,this.mainContainer=null,this.orientation="portrait",this.curPath=null,this.resPool=null,this.mdiManager=null,this.keyDownListeners=null,this.keyUpListeners=null}function onCloseApp(){setTimeout(function(){theApp.onClose()||window.exec(null,null,"AppPlugin","CloseApp",[])},0)}function onOpenDocument(t){}function AfcMessageBox(t,e,n,i){if(!window.AMessageBox)return null;var o=new AMessageBox;return o.openBox(null,e,n,i),o.setTitleText(t),o}AApplication.prototype.unitTest=function(t){this.rootContainer.$ele.children().hide(),new APage("unit").open(t)},AApplication.prototype.onReady=function(){this.setCurrentPath(),window.ResPool&&(this.resPool=new ResPool),window.MDIManager&&(this.mdiManager=new MDIManager),this.rootContainer=new AContainer,this.rootContainer.init($("body")[0]),this.rootContainer.$ele.attr("x-ms-format-detection","none"),this.initKeyEvent();var t=this;window.addEventListener("orientationchange",function(){switch(window.orientation){case 0:case 180:t.orientation="portrait";break;case 90:case-90:t.orientation="landscape"}},!1),window.addEventListener("resize",function(){theApp.mainContainer?theApp.mainContainer.onResize():ANavigator.reportResizeEvent()}),afc.isIos&&!afc.isHybrid&&this.rootContainer.element.addEventListener("touchstart",function(t){t.preventDefault()})},AApplication.prototype.setCurrentPath=function(){var t=decodeURI(window.location.pathname);"WIN"==afc.OS?(t=AUtil.extractLoc(t.replace(/[/]/g,afc.DIV)),this.curPath=t.slice(1,t.length)):(t=AUtil.extractLoc(t),this.curPath=t.slice(0,t.length))},AApplication.prototype.getCurrentPath=function(){return this.curPath},AApplication.prototype.onBackKeyManage=function(){return!!AWindow.reportBackKeyEvent()||ANavigator.reportBackKeyEvent()},AApplication.prototype.getOrientation=function(){return this.orientation},AApplication.prototype.setMainContainer=function(t){this.mainContainer=t},AApplication.prototype.getMainContainer=function(){return this.mainContainer},AApplication.prototype.getRootContainer=function(){return this.rootContainer},AApplication.prototype.getActiveContainer=function(){return this.mdiManager?this.mdiManager.getActiveContainer():null},AApplication.prototype.getActiveView=function(){var t=this.getActiveContainer();return t?t.getView():null},AApplication.prototype.getActiveDocument=function(){var t=this.getActiveContainer();return t?t.getView().getDocument():null},AApplication.prototype.openDocTmplFile=function(t){return!!this.mdiManager&&this.mdiManager.openDocContainer(t)},AApplication.prototype.saveActiveDocTmplFile=function(){if(!this.mdiManager)return!1;var t=this.getActiveDocument();t&&this.mdiManager.saveDocContainer(t.uri)},AApplication.prototype.closeActiveDocTmplFile=function(t,e,n){if(!this.mdiManager)return!1;var i=this.getActiveDocument();i?this.mdiManager.closeDocContainer(i.uri,t,e,n):t&&t(-1)},AApplication.prototype.initKeyEvent=function(){var t=this.keyDownListeners=[],e=this.keyUpListeners=[];$(document).keydown(function(e){"MAC"==afc.OS&&(e.ctrlKey=e.metaKey);for(var n=t.length-1;n>-1&&!t[n].onKeyDown(e);n--);}),$(document).keyup(function(t){"MAC"==afc.OS&&(t.ctrlKey=t.metaKey);for(var n=e.length-1;n>-1&&!e[n].onKeyUp(t);n--);})},AApplication.prototype.addKeyEventListener=function(t,e){this.removeKeyEventListener(t,e),"keydown"==t?this.keyDownListeners.push(e):this.keyUpListeners.push(e)},AApplication.prototype.removeKeyEventListener=function(t,e){var n=this.keyUpListeners;"keydown"==t&&(n=this.keyDownListeners);for(var i=0;i<n.length;i++)if(n[i]===e){n.splice(i,1);break}},AApplication.prototype.onClose=function(){return!1},AApplication.prototype.onError=function(t,e,n){var i=t+", Line - "+n+", "+e;return AfcMessageBox("error",i),i};